# FMS Delta
Скрипт скачивает реестр недействительных паспортов с ФМС МВД и вычисляет новые добавленные и удаленные паспорта

## Краткая информация
Задача выполнена в рамках проекта __GlowByte__

### Ресурсы и инструменты
Использовался __Python 3.7__

#### Система разработки:
- OS: Windows 10 x64
- RAM: 8GB
- Core: i3

#### Ресурсы:
- 115 000 000 паспортов в реестре
- 900 MB RAM
- time ~ 20 minutes (all)
- time ~ 3 minutes (fast calc delta)

## Поедварительная настройка
Возможна динамическая настройка скрипта через изменение параметров, приведенных ниже.

При первичном запуске сменить `pure_start = 1`. 
```py
# ------------------------------ Динамические переменные ------------------------------ # 

# Ссылка на реестр недействительных паспортов с сайта МВД
fms_url = 'http://guvm.mvd.ru/upload/expired-passports/list_of_expired_passports.csv.bz2'
# Флаг запуска. Поставить 1 при первичном запуске. Скачивание + парсинг. Без дельты.
pure_start = 0
# Вид бэкап файлов. Сейчас: list_of_expired_passports_date.txt, delta_date.txt
# Выполнить pure_start = 1 после изменения. Менять только 'date'
postfix = '_' + datetime.today().strftime('%Y%m%d') + '.txt' # _date.txt
# Выбор функции вычисления дельты. Стабильная - медленная, включать по необходимости (инкремент)
delta_type = 'fast' # 'fast' / 'stable'
# Размер блока чтения (в строках). Больше значение - Больше расход RAM (для calcDeltaStable)
blocksize = 15 * 10 ** 6

# ------------------------------------------------------------------------------------- #
```

## Запуск
Для запуска скрипта необходимо выполнить следующую команду. 
```bash
# used python 3.7
python FMSDelta.py
```

## Результат
### Структура проекта
```py
-backup/ # директория с файлами бэкапов, не больше трех штук, автоматическое удаление
-delta/ # директория с файлами посчитанных дельт, неограниченное количество
-log/ # директория лог файлов, неограниченное количество
FMSDelta.py # скрипт
brokenData.txt # текстовый файл, полученный в результате парсинга реестра, содержит битые данные
README.md # этот текстовый документ
```
